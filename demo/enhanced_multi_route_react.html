<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maritime ACPS - Enhanced Multi-Route Planning</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0a0e1a; color: #fff; overflow: hidden; }
        
        .dashboard { display: grid; grid-template-columns: 280px 1fr 320px; height: 100vh; }
        
        .sidebar { background: rgba(255,255,255,0.05); padding: 1rem; border-right: 1px solid rgba(255,255,255,0.1); overflow-y: auto; }
        .sidebar h3 { color: #00ff88; margin-bottom: 1rem; font-size: 1rem; }
        
        .map-container { position: relative; background: #1a1a2e; overflow: hidden; }
        .map-canvas { width: 100%; height: 100%; background: linear-gradient(45deg, #16213e 0%, #0f3460 100%); position: relative; }
        
        .convoy { position: absolute; width: 20px; height: 20px; background: #00ff88; border-radius: 50%; 
                 box-shadow: 0 0 20px #00ff88; transition: all 0.3s ease; z-index: 10; }
        .convoy::after { content: '🚢'; position: absolute; top: -5px; left: -2px; font-size: 16px; }
        
        .object { position: absolute; width: 15px; height: 15px; border-radius: 50%; z-index: 5; transition: all 0.3s ease; }
        .object.threat { background: #ff4444; box-shadow: 0 0 15px #ff4444; }
        .object.benign { background: #4ecdc4; box-shadow: 0 0 15px #4ecdc4; }
        .object.unknown { background: #ffaa00; box-shadow: 0 0 15px #ffaa00; }
        
        .destination { position: absolute; width: 15px; height: 15px; background: #ff6b6b; border-radius: 50%;
                      box-shadow: 0 0 15px #ff6b6b; z-index: 8; text-align: center; line-height: 15px; }
        
        .path-optimal { position: absolute; height: 3px; background: linear-gradient(90deg, #00ff88, #ffaa00);
                       box-shadow: 0 0 8px rgba(0,255,136,0.8); z-index: 4; transform-origin: left center; }
        .path-fastest { position: absolute; height: 2px; background: linear-gradient(90deg, #ff6b6b, #ffa500);
                       box-shadow: 0 0 6px rgba(255,107,107,0.6); z-index: 3; transform-origin: left center; opacity: 0.7; }
        .path-safest { position: absolute; height: 2px; background: linear-gradient(90deg, #4ecdc4, #45b7d1);
                      box-shadow: 0 0 6px rgba(78,205,196,0.6); z-index: 3; transform-origin: left center; opacity: 0.7; }
        
        .threat-zone { position: absolute; border: 2px dashed #ff4444; border-radius: 50%;
                      background: rgba(255,68,68,0.1); z-index: 1; transition: all 0.3s ease; }
        
        .status-panel { background: rgba(0,0,0,0.3); padding: 0.8rem; margin-bottom: 0.8rem; border-radius: 6px; }
        .status-item { margin: 0.3rem 0; padding: 0.4rem; background: rgba(255,255,255,0.05); border-radius: 4px; font-size: 0.85rem; }
        
        .threat-alert { background: rgba(255,68,68,0.2); border-left: 4px solid #ff4444; }
        .safe-status { background: rgba(0,255,136,0.2); border-left: 4px solid #00ff88; }
        .ml-analyzing { background: rgba(255,170,0,0.2); border-left: 4px solid #ffaa00; }
        
        .route-option { background: rgba(255,255,255,0.08); border-radius: 6px; padding: 0.8rem; margin: 0.5rem 0; 
                       border-left: 4px solid #666; cursor: pointer; transition: all 0.3s ease; }
        .route-option:hover { background: rgba(255,255,255,0.12); }
        .route-option.selected { border-left-color: #00ff88; background: rgba(0,255,136,0.1); }
        .route-option.optimal { border-left-color: #00ff88; }
        .route-option.fastest { border-left-color: #ff6b6b; }
        .route-option.safest { border-left-color: #4ecdc4; }
        
        .route-metrics { font-size: 0.75rem; margin-top: 0.3rem; }
        .metric { display: inline-block; margin-right: 0.8rem; }
        
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
                   background: rgba(0,0,0,0.8); padding: 1rem; border-radius: 10px; }
        .btn { background: #2a5298; color: white; border: none; padding: 0.6rem 1.2rem; 
              border-radius: 5px; cursor: pointer; margin: 0 0.3rem; font-size: 0.85rem; }
        .btn:hover { background: #1e3c72; }
        .btn.danger { background: #ff4444; }
        .btn.success { background: #00ff88; color: #000; }
        
        .metrics { font-size: 0.8rem; }
        .metric-value { font-weight: bold; color: #00ff88; }
        
        .scenario-indicator { position: absolute; top: 15px; left: 15px; 
                            background: rgba(0,0,0,0.8); padding: 0.8rem; border-radius: 6px; }
        
        .calculation-status { position: absolute; top: 15px; right: 15px;
                            background: rgba(0,0,0,0.8); padding: 0.8rem; border-radius: 6px; }
        
        .grid-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                       background-image: 
                         linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                         linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
                       background-size: 40px 40px; z-index: 0; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        const EnhancedMultiRoute = () => {
            const [convoy, setConvoy] = useState({ x: 100, y: 400, lat: 25.7617, lon: -80.1918 });
            const [destination] = useState({ x: 700, y: 200, lat: 25.8200, lon: -80.1200 });
            const [running, setRunning] = useState(false);
            const [speed, setSpeed] = useState(1);
            const [selectedRoute, setSelectedRoute] = useState('optimal');
            const [routes, setRoutes] = useState({});
            const [detectedObjects, setDetectedObjects] = useState(new Set());
            const [mlClassifications, setMlClassifications] = useState(new Map());
            const [calculationInProgress, setCalculationInProgress] = useState(false);
            
            const marineObjects = useRef([
                { x: 300, y: 450, vx: -2, vy: -3, type: 'small_fast_craft', radius: 70, name: 'Pirate Skiff Alpha', speed: 3.5, behavior: 'intercept', isThreat: true },
                { x: 180, y: 200, vx: 2.5, vy: 1, type: 'small_fast_craft', radius: 65, name: 'Pirate Skiff Beta', speed: 3.2, behavior: 'intercept', isThreat: true },
                { x: 400, y: 400, vx: 0.5, vy: 0, type: 'fishing_vessel', radius: 50, name: 'Fishing Boat', speed: 1.0, behavior: 'drift', isThreat: false }
            ]);
            
            useEffect(() => {
                setTimeout(() => calculateRoutes(), 500);
            }, []);
            
            useEffect(() => {
                let interval;
                if (running) {
                    interval = setInterval(() => {
                        detectObjects();
                        moveConvoy();
                    }, 100 / speed);
                }
                return () => clearInterval(interval);
            }, [running, speed, selectedRoute, routes]);
            
            const calculateRoutes = () => {
                setCalculationInProgress(true);
                setTimeout(() => {
                    const newRoutes = {
                        optimal: { waypoints: generateWaypoints('optimal'), metrics: { distance: '8.2', threatExposure: '2.1', score: '85' } },
                        fastest: { waypoints: generateWaypoints('fastest'), metrics: { distance: '7.8', threatExposure: '3.2', score: '78' } },
                        safest: { waypoints: generateWaypoints('safest'), metrics: { distance: '9.1', threatExposure: '1.2', score: '82' } }
                    };
                    setRoutes(newRoutes);
                    setCalculationInProgress(false);
                }, 1500);
            };
            
            const generateWaypoints = (strategy) => {
                const waypoints = [];
                for (let i = 1; i <= 8; i++) {
                    const progress = i / 8;
                    let x = convoy.x + (destination.x - convoy.x) * progress;
                    let y = convoy.y + (destination.y - convoy.y) * progress;
                    
                    if (strategy === 'safest') {
                        y -= 60 * Math.sin(progress * Math.PI);
                    }
                    waypoints.push({ x, y });
                }
                return waypoints;
            };
            
            const detectObjects = () => {
                marineObjects.current.forEach((obj, i) => {
                    const distance = Math.sqrt((convoy.x - obj.x)**2 + (convoy.y - obj.y)**2);
                    if (distance < obj.radius * 2.0) {
                        setDetectedObjects(prev => new Set([...prev, i]));
                        setMlClassifications(prev => new Map(prev.set(i, { 
                            threat_detected: obj.isThreat, 
                            confidence: 0.85 
                        })));
                    }
                });
            };
            
            const moveConvoy = () => {
                if (!routes[selectedRoute]?.waypoints?.length) return;
                
                const target = routes[selectedRoute].waypoints[0];
                const dx = target.x - convoy.x;
                const dy = target.y - convoy.y;
                const distance = Math.sqrt(dx*dx + dy*dy);
                
                if (distance < 15) {
                    routes[selectedRoute].waypoints.shift();
                    if (routes[selectedRoute].waypoints.length === 0) {
                        setRunning(false);
                        return;
                    }
                } else {
                    const moveSpeed = 3 * speed;
                    setConvoy(prev => ({
                        ...prev,
                        x: prev.x + (dx / distance) * moveSpeed,
                        y: prev.y + (dy / distance) * moveSpeed
                    }));
                }
            };
            
            const renderRoutes = () => {
                return Object.keys(routes).map(strategy => {
                    const route = routes[strategy];
                    if (!route?.waypoints) return null;
                    
                    let prevPoint = convoy;
                    const opacity = selectedRoute === strategy ? '1' : '0.3';
                    
                    return route.waypoints.map((wp, index) => {
                        const dx = wp.x - prevPoint.x;
                        const dy = wp.y - prevPoint.y;
                        const length = Math.sqrt(dx*dx + dy*dy);
                        const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                        
                        const line = React.createElement('div', {
                            key: `${strategy}-${index}`,
                            className: `path-${strategy}`,
                            style: {
                                left: `${prevPoint.x}px`,
                                top: `${prevPoint.y}px`,
                                width: `${length}px`,
                                transform: `rotate(${angle}deg)`,
                                opacity
                            }
                        });
                        
                        prevPoint = wp;
                        return line;
                    });
                });
            };
            
            return React.createElement('div', { className: 'dashboard' }, [
                // Left Sidebar
                React.createElement('div', { key: 'sidebar1', className: 'sidebar' }, [
                    React.createElement('h3', { key: 'h1' }, '🛡️ System Status'),
                    React.createElement('div', { key: 'status', className: 'status-panel' }, [
                        React.createElement('div', { key: 's1', className: 'status-item safe-status' }, React.createElement('strong', null, 'System: OPERATIONAL')),
                        React.createElement('div', { key: 's2', className: 'status-item' }, 'ML Model: Active (92.86% accuracy)'),
                        React.createElement('div', { key: 's3', className: 'status-item' }, 'Drones: 4/4 Online')
                    ]),
                    React.createElement('h3', { key: 'h2' }, '📊 Current Metrics'),
                    React.createElement('div', { key: 'metrics', className: 'status-panel metrics' }, [
                        React.createElement('div', { key: 'm1' }, ['Position: ', React.createElement('span', { className: 'metric-value' }, `${convoy.lat.toFixed(4)}, ${convoy.lon.toFixed(4)}`)]),
                        React.createElement('div', { key: 'm2' }, ['Speed: ', React.createElement('span', { className: 'metric-value' }, '12 knots')]),
                        React.createElement('div', { key: 'm3' }, ['Heading: ', React.createElement('span', { className: 'metric-value' }, '090°')])
                    ])
                ]),
                
                // Map Container
                React.createElement('div', { key: 'map-container', className: 'map-container' }, [
                    React.createElement('div', { key: 'scenario', className: 'scenario-indicator' }, [
                        React.createElement('h4', null, 'Enhanced Multi-Route Planning'),
                        React.createElement('p', null, 'ML-powered threat detection active...')
                    ]),
                    calculationInProgress && React.createElement('div', { key: 'calc', className: 'calculation-status' }, '🧠 Analyzing Routes...'),
                    React.createElement('div', { key: 'canvas', className: 'map-canvas' }, [
                        React.createElement('div', { key: 'grid', className: 'grid-overlay' }),
                        React.createElement('div', { 
                            key: 'convoy', 
                            className: 'convoy',
                            style: { left: `${convoy.x}px`, top: `${convoy.y}px` }
                        }),
                        React.createElement('div', { 
                            key: 'dest', 
                            className: 'destination',
                            style: { 
                                left: `${destination.x}px`, 
                                top: `${destination.y}px`,
                                fontSize: '12px',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center'
                            }
                        }, '🎯'),
                        ...renderRoutes()
                    ])
                ]),
                
                // Right Sidebar
                React.createElement('div', { key: 'sidebar2', className: 'sidebar' }, [
                    React.createElement('h3', { key: 'h3' }, '🗺️ Route Options'),
                    React.createElement('div', { key: 'routes' }, [
                        ['optimal', '🎯 Optimal Route'],
                        ['fastest', '⚡ Fastest Route'],
                        ['safest', '🛡️ Safest Route']
                    ].map(([type, label]) => 
                        React.createElement('div', {
                            key: type,
                            className: `route-option ${type} ${selectedRoute === type ? 'selected' : ''}`,
                            onClick: () => setSelectedRoute(type)
                        }, [
                            React.createElement('strong', { key: 'label' }, label),
                            React.createElement('div', { key: 'metrics', className: 'route-metrics' }, [
                                React.createElement('span', { key: 'd', className: 'metric' }, `Distance: ${routes[type]?.metrics.distance || '--'}km`),
                                React.createElement('span', { key: 'r', className: 'metric' }, `Risk: ${routes[type]?.metrics.threatExposure || '--'}`),
                                React.createElement('span', { key: 's', className: 'metric' }, `Score: ${routes[type]?.metrics.score || '--'}`)
                            ])
                        ])
                    ))
                ])
            ]);
        };
        
        const Controls = () => {
            return React.createElement('div', { className: 'controls' }, [
                React.createElement('button', { 
                    key: 'start', 
                    className: 'btn success', 
                    onClick: () => setRunning(true) 
                }, '▶️ Start Demo'),
                React.createElement('button', { 
                    key: 'pause', 
                    className: 'btn', 
                    onClick: () => setRunning(false) 
                }, '⏸️ Pause'),
                React.createElement('button', { 
                    key: 'stop', 
                    className: 'btn danger', 
                    onClick: () => { setRunning(false); setConvoy({ x: 100, y: 400, lat: 25.7617, lon: -80.1918 }); } 
                }, '⏹️ Stop')
            ]);
        };
        
        const App = () => {
            return React.createElement('div', null, [
                React.createElement(EnhancedMultiRoute, { key: 'dashboard' }),
                React.createElement(Controls, { key: 'controls' })
            ]);
        };
        
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>